# OpenCut - æ—…æ¸¸è§†é¢‘å…¨è‡ªåŠ¨å‰ªè¾‘ç³»ç»Ÿ

> ä¸“ä¸ºæ—…æ¸¸åšä¸»è®¾è®¡çš„ AI å‰ªè¾‘åŠ©æ‰‹ã€‚8TB ç´ æå…¨è‡ªåŠ¨ç®¡ç†ã€å‰§æœ¬è‡ªé€‚åº”ã€ä¸€é”®æˆç‰‡ã€‚

[![Python 3.8+](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![FFmpeg](https://img.shields.io/badge/ffmpeg-4.0+-green.svg)](https://ffmpeg.org/)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## ğŸ¯ é¡¹ç›®æ„¿æ™¯

**è®©ä»»ä½•äººéƒ½èƒ½åœ¨ 10 åˆ†é’Ÿå†…ï¼Œç”¨è‡ªå·±çš„ç´ æå‰ªå‡ºç”µå½±æ„Ÿæ—…æ¸¸è§†é¢‘ã€‚**

- âœ… 8TB ç´ æå…¨è‡ªåŠ¨ç´¢å¼•ï¼ˆæŒ‡çº¹å»é‡ + è¯­ä¹‰æœç´¢ï¼‰
- âœ… å‰§æœ¬è‡ªé€‚åº”é‡å†™ï¼ˆç´ æä¸å¤Ÿæ—¶è‡ªåŠ¨æ”¹æˆï¼‰
- âœ… å…¨è‡ªåŠ¨æ¸²æŸ“ï¼ˆç£¨çš®/è°ƒè‰²/å­—å¹•/å¯¹æ‹ï¼‰
- âœ… ä¸‰çº§å“¨ä½ç¡®è®¤ï¼ˆä½ åªç®¡ç‚¹ç¡®è®¤ï¼Œå‰©ä¸‹çš„äº¤ç»™ AIï¼‰

---

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  8TB ç´ æåº“ (ç™¾åº¦äº‘/Google Drive/æœ¬åœ°)                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ—‚ï¸ Asset Indexer            â”‚  â† æŒ‡çº¹å»é‡ + CLIP è¯­ä¹‰ç´¢å¼•
â”‚  â€¢ fingerprint_scanner       â”‚     å¿«é€Ÿå®šä½æœ€ä½³ç´ æ
â”‚  â€¢ semantic_search           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ è¿”å› Top-K ç´ æ
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¬ Script Engine            â”‚  â† å‰§æœ¬è‡ªé€‚åº”é‡å†™
â”‚  â€¢ adaptive_rewriter         â”‚     ç´ æä¸è¶³æ—¶è‡ªåŠ¨æ”¹æ–‡æ¡ˆ
â”‚  â€¢ emotion_curve             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ ä¸‰çº§å“¨ä½ç¡®è®¤
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ¨ Render Pipeline          â”‚  â† å…¨è‡ªåŠ¨æ¸²æŸ“
â”‚  â€¢ beauty_filter (ç£¨çš®)      â”‚     MediaPipe + FFmpeg
â”‚  â€¢ color_grading (è°ƒè‰²)      â”‚     YUV è‚¤è‰²ä¿æŠ¤
â”‚  â€¢ subtitle_burn (å­—å¹•)      â”‚     Whisper + åŒè¯­
â”‚  â€¢ beat_sync (å¯¹æ‹)          â”‚     BPM é”šç‚¹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â–¼
           ğŸ“¹ æˆç‰‡è¾“å‡º
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/opencut.git
cd opencut

# å®‰è£… Python ä¾èµ–
pip install -r requirements.txt

# å®‰è£… FFmpeg (å¿…éœ€)
# macOS: brew install ffmpeg
# Ubuntu: sudo apt install ffmpeg
# Windows: https://ffmpeg.org/download.html
```

### 2. é…ç½®

```bash
# å¤åˆ¶é…ç½®æ¨¡æ¿
cp config.example.json config.json

# ç¼–è¾‘ config.json
{
  "storage": {
    "type": "local",  // æˆ– "google_drive", "baiduyun"
    "path": "/path/to/your/8tb/videos"
  },
  "models": {
    "clip_model": "openai/clip-vit-base-patch32",
    "whisper_model": "base",  // faster-whisper
    "sovits_model": "path/to/your/voice.pth"  // å¯é€‰ï¼Œå£°çº¹å…‹éš†
  },
  "render": {
    "beauty_intensity": 0.7,      // ç£¨çš®å¼ºåº¦ 0-1
    "lut_preset": "wanderlust",   // è°ƒè‰²é£æ ¼
    "output_resolution": [1080, 1920],  // 9:16
    "beat_sync": true             // æ˜¯å¦å¯ç”¨ BPM å¯¹æ‹
  }
}
```

### 3. ç¬¬ä¸€æ­¥ï¼šå»ºç«‹ç´ æç´¢å¼•ï¼ˆä¸€æ¬¡æ€§ï¼‰

```bash
# æ‰«æ 8TB ç´ æï¼Œå»ºç«‹æŒ‡çº¹ + è¯­ä¹‰ç´¢å¼•
python -m opencut.indexer scan \
  --input /path/to/videos \
  --output ./index/

# è¾“å‡ºï¼š
# â€¢ fingerprints.db  (å»é‡æ•°æ®åº“)
# â€¢ semantic_index.json  (CLIP è¯­ä¹‰å‘é‡)
```

### 4. ç¬¬äºŒæ­¥ï¼šå…¨è‡ªåŠ¨å‰ªè¾‘

```bash
# è¾“å…¥ä½ çš„ä¸»é¢˜ï¼Œç³»ç»Ÿè‡ªåŠ¨å®Œæˆä¸€åˆ‡
python -m opencut.editor create \
  --topic "æ ¼é²å‰äºšå±±é¡¶çš„æ—¥è½" \
  --style "æ¸…å†·æµæµªæ„Ÿ" \
  --music "lofi-chill" \
  --output ./output/

# ç³»ç»Ÿä¼šä¾æ¬¡æ‰§è¡Œï¼š
# 1. è¯­ä¹‰æœç´¢åŒ¹é…ç´ æ
# 2. å‰§æœ¬è‡ªé€‚åº”é‡å†™ï¼ˆå¦‚æœç´ æä¸å¤Ÿï¼‰
# 3. ä¸‰çº§å“¨ä½ç¡®è®¤ï¼ˆDiscord/CLI äº¤äº’ï¼‰
# 4. å…¨è‡ªåŠ¨æ¸²æŸ“ï¼ˆç£¨çš®/è°ƒè‰²/å­—å¹•/å¯¹æ‹ï¼‰
```

---

## ğŸ“‹ æ ¸å¿ƒåŠŸèƒ½è¯¦è§£

### ğŸ—‚ï¸ Asset Indexer - æ™ºèƒ½ç´ æç®¡ç†

**é—®é¢˜**ï¼š8TB ç´ æå¦‚ä½•å¿«é€Ÿæ‰¾åˆ°"æ ¼é²å‰äºšå±±é¡¶æ—¥è½"çš„é‚£ 3 ç§’ï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š

```python
from opencut.indexer import AssetIndex

# åˆå§‹åŒ–ç´¢å¼•
index = AssetIndex.load("./index/")

# è¯­ä¹‰æœç´¢
results = index.search(
    query="æ ¼é²å‰äºš å±±é¡¶ æ—¥è½ äººç‰©",
    top_k=5,
    min_duration=3.0
)

# è¿”å›ç»“æ„åŒ–æ•°æ®
[
  {
    "clip_id": "abc123",
    "file_path": "/videos/georgia/dji_001.mp4",
    "time_range": [120.5, 125.0],
    "similarity_score": 0.87,
    "visual_tags": ["sunset", "mountain", "person"],
    "quality_score": 0.92
  }
]
```

**æŠ€æœ¯ç»†èŠ‚**ï¼š
- **æŒ‡çº¹å»é‡**ï¼šPerceptual Hash (pHash) æ£€æµ‹é‡å¤/ç›¸ä¼¼ç‰‡æ®µ
- **è¯­ä¹‰ç´¢å¼•**ï¼šCLIP æ¨¡å‹æå– 512 ç»´è§†è§‰ç‰¹å¾
- **å¢é‡æ›´æ–°**ï¼šæ–°å¢ç´ ææ—¶åªè®¡ç®—æ–°æ–‡ä»¶ï¼Œæ— éœ€é‡æ‰« 8TB

---

### ğŸ¬ Script Engine - å‰§æœ¬è‡ªé€‚åº”

**é—®é¢˜**ï¼šå‰§æœ¬å†™"åœ¨é›ªåœ°é‡Œå¥”è·‘"ï¼Œä½†ç´ æåªæœ‰"èµ°è·¯"æ€ä¹ˆåŠï¼Ÿ

**è§£å†³æ–¹æ¡ˆ**ï¼š

```python
from opencut.script import AdaptiveScript

script = AdaptiveScript(
    original="æˆ‘åœ¨é›ªåœ°é‡Œå¥”è·‘ï¼Œæ„Ÿå—è‡ªç”±çš„é£",
    required_visual=["snow", "running", "person"]
)

# å½“ç´ æåŒ¹é…åº¦ < 0.6 æ—¶è‡ªåŠ¨é‡å†™
if best_match.score < 0.6:
    new_script = script.rewrite(
        available_tags=["snow", "walking", "person"],
        emotion="nostalgic"
    )
    # è¾“å‡º: "æˆ‘åœ¨é›ªåœ°é‡Œæ¼«æ­¥ï¼Œä»»æ€ç»ªéšé£é£˜æ•£"
```

**ä¸‰çº§å“¨ä½ç¡®è®¤æµ**ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  å“¨ä½ 1      â”‚ -> â”‚  å“¨ä½ 2      â”‚ -> â”‚  å“¨ä½ 3      â”‚
â”‚ å‰§æœ¬ç¡®è®¤     â”‚    â”‚ ç´ æä¿®æ­£     â”‚    â”‚ æ ·ç‰‡ç¡®è®¤     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ â€¢ æ–‡æ¡ˆ       â”‚    â”‚ â€¢ å¹³æ›¿å¯¹æ¯”   â”‚    â”‚ â€¢ 15s æ ·ç‰‡  â”‚
â”‚ â€¢ æƒ…ç»ªæ›²çº¿   â”‚    â”‚ â€¢ é¢„è§ˆå›¾     â”‚    â”‚ â€¢ ç£¨çš®/è°ƒè‰² â”‚
â”‚ â€¢ éŸ³ä¹é€‰å‹   â”‚    â”‚ â€¢ 10minè¶…æ—¶  â”‚    â”‚ â€¢ æœ€ç»ˆç¡®è®¤  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

### ğŸ¨ Render Pipeline - å…¨è‡ªåŠ¨æ¸²æŸ“

#### 1. æ™ºèƒ½ç£¨çš® (Beauty Filter)

```python
from opencut.render import BeautyFilter

# MediaPipe äººè„¸æ£€æµ‹ + é¢‘ç‡åˆ†è§£
filter = BeautyFilter(
    method="frequency_separation",
    skin_smooth_sigma=1.5,
    preserve_features=["eyes", "eyebrows", "lips"]  # ä¿æŠ¤äº”å®˜ç»†èŠ‚
)

# åªå¯¹çš®è‚¤åŒºåŸŸè¿›è¡Œå¹³æ»‘ï¼Œä¿ç•™çº¹ç†
output = filter.apply(input_frame)
```

#### 2. è‚¤è‰²ä¿æŠ¤è°ƒè‰² (Color Grading)

```python
from opencut.render import ColorGrading

grading = ColorGrading(
    lut_preset="wanderlust",      # æ¸…å†·ä½é¥±å’Œé£æ ¼
    skin_tone_protection=True,    # YUV è‚¤è‰²ç©ºé—´é”å®š
    skin_tone_range={"cb": [77, 127], "cr": [133, 173]}
)

# èƒŒæ™¯å¥—ç”¨ç”µå½±æ„Ÿ LUTï¼Œè‚¤è‰²ä¿æŒè‡ªç„¶
output = grading.apply(input_frame)
```

#### 3. ä¸­è‹±åŒè¯­å­—å¹• (Bilingual Subtitles)

```python
from opencut.render import SubtitleEngine

engine = SubtitleEngine(
    whisper_model="faster-whisper-base",
    font="Noto Sans CJK SC",
    style="movie_caption"  # ç”µå½±æ„Ÿæ ·å¼
)

# è‡ªåŠ¨è¯†åˆ«æ—ç™½ -> ç¿»è¯‘ -> å‹åˆ¶
engine.generate(
    audio_path="voiceover.wav",
    cn_text="æ—…è¡Œçš„æ„ä¹‰",
    style={"outline": 2, "margin_v": 60}
)
```

#### 4. BPM å¯¹æ‹ (Beat Sync)

```python
from opencut.render import BeatSync

sync = BeatSync(
    bpm_detection="librosa",
    alignment="peak",  # å¯¹é½é¼“ç‚¹å³°å€¼
    tolerance_frames=3  # å®¹é”™ 3 å¸§
)

# è‡ªåŠ¨è°ƒæ•´ç‰‡æ®µå…¥å‡ºç‚¹
aligned_clips = sync.align(clips, music_path="bgm.mp3")
```

---

## ğŸ› ï¸ è¿›é˜¶ç”¨æ³•

### æ‰¹é‡å¤„ç†

```bash
# æ‰¹é‡ç”Ÿæˆå¤šä¸ªä¸»é¢˜
python -m opencut.batch \
  --topics topics.txt \
  --template "wanderlust" \
  --output ./batch_output/
```

### è‡ªå®šä¹‰ LUT

```bash
# æ·»åŠ ä½ è‡ªå·±çš„è°ƒè‰²é¢„è®¾
python -m opencut.lut add \
  --name "my_style" \
  --cube ./my_style.cube \
  --description "æˆ‘çš„ä¸“å±æµæµªæ„Ÿ"
```

### API æ¨¡å¼

```python
from opencut import OpenCutPipeline

pipeline = OpenCutPipeline(config="./config.json")

# ä¸€é”®æ‰§è¡Œå…¨æµç¨‹
video = pipeline.create(
    topic="å†°å²›é»‘æ²™æ»©çš„å­¤ç‹¬",
    materials_index="./index/",
    confirm_mode="auto"  # æˆ– "interactive" å¯ç”¨å“¨ä½ç¡®è®¤
)

print(f"æˆç‰‡å·²ç”Ÿæˆ: {video.path}")
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
opencut/
â”œâ”€â”€ README.md
â”œâ”€â”€ requirements.txt
â”œâ”€â”€ config.example.json
â”œâ”€â”€ opencut/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ indexer/              # ç´ æç´¢å¼•
â”‚   â”‚   â”œâ”€â”€ fingerprint.py    # è§†é¢‘æŒ‡çº¹
â”‚   â”‚   â”œâ”€â”€ semantic.py       # CLIP è¯­ä¹‰ç´¢å¼•
â”‚   â”‚   â””â”€â”€ search.py         # å¤šç»´åº¦æœç´¢
â”‚   â”œâ”€â”€ script/               # å‰§æœ¬å¼•æ“
â”‚   â”‚   â”œâ”€â”€ adaptive.py       # è‡ªé€‚åº”é‡å†™
â”‚   â”‚   â”œâ”€â”€ emotion.py        # æƒ…ç»ªæ›²çº¿
â”‚   â”‚   â””â”€â”€ confirmation.py   # å“¨ä½ç¡®è®¤æµ
â”‚   â”œâ”€â”€ render/               # æ¸²æŸ“ç®¡é“
â”‚   â”‚   â”œâ”€â”€ beauty.py         # ç£¨çš®
â”‚   â”‚   â”œâ”€â”€ color.py          # è°ƒè‰²
â”‚   â”‚   â”œâ”€â”€ subtitle.py       # å­—å¹•
â”‚   â”‚   â””â”€â”€ sync.py           # BPM å¯¹æ‹
â”‚   â””â”€â”€ editor.py             # ä¸»ç¼–è¾‘å™¨
â”œâ”€â”€ tests/                    # æµ‹è¯•ç”¨ä¾‹
â”œâ”€â”€ examples/                 # ç¤ºä¾‹è„šæœ¬
â””â”€â”€ docs/                     # è¯¦ç»†æ–‡æ¡£
```

---

## ğŸ§ª æµ‹è¯•

```bash
# è¿è¡Œå•å…ƒæµ‹è¯•
pytest tests/

# è¿è¡Œé›†æˆæµ‹è¯•ï¼ˆéœ€è¦æµ‹è¯•è§†é¢‘ï¼‰
pytest tests/integration/ --videos ./test_videos/
```

---

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿ PRï¼è¯·éµå¾ªä»¥ä¸‹æµç¨‹ï¼š

1. Fork é¡¹ç›®
2. åˆ›å»ºåŠŸèƒ½åˆ†æ”¯ (`git checkout -b feature/amazing-feature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add amazing feature'`)
4. æ¨é€åˆ†æ”¯ (`git push origin feature/amazing-feature`)
5. åˆ›å»º Pull Request

---

## ğŸ“„ è®¸å¯è¯

MIT License - è¯¦è§ [LICENSE](LICENSE)

---

## ğŸ™ è‡´è°¢

- [FFmpeg](https://ffmpeg.org/) - è§†é¢‘å¤„ç†å¼•æ“
- [OpenAI CLIP](https://github.com/openai/CLIP) - è¯­ä¹‰ç†è§£
- [Faster-Whisper](https://github.com/SYSTRAN/faster-whisper) - è¯­éŸ³è¯†åˆ«
- [GPT-SoVITS](https://github.com/RVC-Boss/GPT-SoVITS) - å£°éŸ³å…‹éš†

---

**Made with â¤ï¸ for travelers who want to tell their stories.**
